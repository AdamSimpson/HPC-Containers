# Defines a Singularity container with TensorFlow pre-installed
#
BootStrap: docker
From: ubuntu:zesty

%setup
  cp tensorflow.post ${SINGULARITY_ROOTFS}

  # Setup the environment to be sued in the container
  echo "" >> ${SINGULARITY_ROOTFS}/environment
  echo "export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/usr/lib/jvm/java-8-openjdk-amd64/bin" >> ${SINGULARITY_ROOTFS}/environment
  echo "export LD_LIBRARY_PATH=/usr/local/lib:/lib64/usr/lib/x86_64-linux-gnu" >> ${SINGULARITY_ROOTFS}/environment
  echo "export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64" >> ${SINGULARITY_ROOTFS}/environment

%post
  . /environment
  . ./tensorflow.post

%runscript
    exec /usr/bin/python "$@"
